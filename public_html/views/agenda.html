<h1 class="text-center">
    Calendario delle lezioni
</h1>

    <!-- div class="alert alert-warning">
        <h4>Esercizio</h4>
        <p>
           Per completare questo esercizio servir√†
           gestire il caricamento dinamico del calendario e
           attivare il comportamento di add edit e delete appoggiandosi
           ad un form da realizzare sotto al calendario
        </p>
    </div -->

 <div class="agenda col-md-6 col-sm-12" ng-show="agenda.length">
    <div class="well well-sm table table-responsive">
        <table class="table table-condensed table-bordered">
            <thead>
                <tr>
                    <th>Data</th>
                    <th>Orario</th>
                    <th>Lezione</th>
                </tr>
            </thead>
            <tbody ng-repeat="(parent, day) in agenda">
                <!-- Single event in a single day -->
                <tr ng-if="day.events.length <= 1">
                    <td class="agenda-date" class="active" colspan="{{ day.events.length?1:3  }}">
                        <div class="dayofmonth">{{ day.date | date : 'dd' }}</div>
                        <div class="dayofweek">{{ day.date | date : 'EEEE' }}</div>
                        <div class="shortdate text-muted">{{ day.date | date : 'MMMM, yyyy' }}</div>
                        <div class="text-right">
                            <button class="btn btn-sm btn-info"  ng-click="showDay(parent)"><i class="fa fa-pencil"></i></button>
                            <button class="btn btn-sm btn-danger" ng-click="deleteDay(parent)"><i class="fa fa-trash"></i></button>
                        </div>
                    </td>
                    <td ng-if="day.events.length" class="agenda-time">
                        {{ day.events[0].from | date : 'shortTime' }} <span ng-show="event.to"> - {{ day.events[0].to | date : 'shortTime' }}</span>
                    </td>
                    <td ng-if="day.events.length" class="agenda-events">
                        <div class="agenda-event">
                            {{ day.events[0].teacher }} <span ng-show="day.events[0].lesson">-</span>
                            {{ day.events[0].lesson }} <span ng-show="day.events[0].argument">-</span>
                            {{ day.events[0].argument }}
                            <div class="text-right">
                                <button class="btn btn-sm btn-info"  ng-click="showEvent(parent, 0)"><i class="fa fa-pencil"></i></button>
                                <button class="btn btn-sm btn-danger" ng-click="deleteEvent(parent, 0)"><i class="fa fa-trash"></i></button>
                          </div>
                        </div>
                    </td>
                </tr>
                <tr ng-if="day.events.length > 1" ng-repeat="event in day.events">
                    <td class="agenda-date" class="active" rowspan="{{ day.events.length }}" ng-if="$index == 0">
                        <div class="dayofmonth">{{ day.date | date : 'dd' }}</div>
                        <div class="dayofweek">{{ day.date | date : 'EEEE' }}</div>
                        <div class="shortdate text-muted">{{ day.date | date : 'MMMM, yyyy' }}</div>
                        
                        <div class="text-right">
                            <button class="btn btn-sm btn-info"  ng-click="showDay($index)"><i class="fa fa-pencil"></i></button>
                            <button class="btn btn-sm btn-danger" ng-click="deleteDay($index)"><i class="fa fa-trash"></i></button>
                        </div>
                    </td>
                    <td class="agenda-time">
                        {{ event.from | date : 'shortTime' }} <span ng-show="event.to"> - {{ event.to | date : 'shortTime' }}</span>
                    </td>
                    <td class="agenda-events">
                        <div class="agenda-event">
                            {{ event.teacher }} <span ng-show="event.lesson">-</span>
                            {{ event.lesson }} <span ng-show="event.argument">-</span>
                            {{ event.argument }}
                            <div class="text-right">
                                <button class="btn btn-sm btn-info"  ng-click="showEvent(parent, $index)"><i class="fa fa-pencil"></i></button>
                                <button class="btn btn-sm btn-danger" ng-click="deleteEvent(parent, $index)"><i class="fa fa-trash"></i></button>
                            </div>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
        <div class="text-center">
            <button class="btn btn-sm btn-danger" ng-disabled="agenda.length < 1" ng-click="resetAgenda()">Cancella tutto</button>
        </div>
    </div>
</div>
    
<div class="col-md-6 col-sm-12">
    <div class="alert" ng-class="{'alert-warning' : (day.index >= 0), 'alert-info' : !(day.index >= 0) }">
        <h3 class="text-center" ng-show="day.index >= 0">Modifica giornata</h3>
        <h3 class="text-center" ng-hide="day.index >= 0">Nuova giornata</h3>
        <form class="panel-body">
            <div class="form-group col-md-6 col-sm-12">
                  <label for="exampleId1">Data di riferimento</label>
                  <input type="date" class="form-control" data-date-format="dd/mm/yy" data-language="it" name="born" ng-model="day.date" placeholder="gg/mm/aaaa">
            </div>
            
            <div class="col-sm-12" ng-show="(day.events.length) && (day.index != -1)">
                <div class="well well-sm">
                    <ul class="list-group">
                      <li ng-repeat="event in day.events" class="list-group-item">
                            {{ event.from | date : 'shortTime'  }} <span ng-show="event.to">-</span>
                            {{ event.to | date : 'shortTime'  }} <span ng-show="event.teacher">-</span>
                            {{ event.teacher }} <span ng-show="event.lesson">-</span>
                            {{ event.lesson }} <span ng-show="event.argument">-</span>
                            {{ event.argument }}
                          <div class="text-right">
                                <button class="btn btn-sm btn-info"  ng-click="showStudent($index)">Modifica</button>
                                <button class="btn btn-sm btn-danger" ng-click="deleteStudent($index)">Cancella</button>
                          </div>
                      </li>
                    </ul>
                    <div class="text-center">
                        <button class="btn btn-sm btn-danger" ng-click="resetEvents(day.index)">Cancella tutto</button>
                    </div> 
                </div>   
            </div>
            <hr/>
            <div class="col-sm-12 text-center">
                <button ng-click="saveDay(day.index)" class="btn btn-info">Salva</button>
                <button ng-click="resetDay()" ng-disabled="day.index == -1" class="btn btn-primary">Nuovo</button>
            </div>
        </form>
    </div>
</div>